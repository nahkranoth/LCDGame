import random


class World(object):
    top =    [0xFC, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20]
    bottom = [0xFC, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20]

    rock = 0x6F
    empty = 0x20

    def generate_world(self):
        self.top = [0xFC, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20]
        self.bottom = [0xFC, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20]
        return self.merged()

    def get_random_sprite(self, other):
        ri = random.randint(0, 100)
        if ri < 20 and (other[12] == 0x20 and other[13] == 0x20 and other[14] == 0x20 and other[15] == 0x20):
            return self.rock
        else:
            return self.empty

    def merged(self):
        return self.top + self.bottom

    def step(self):
        self.bottom.pop(0)
        self.bottom.append(self.get_random_sprite(self.top))
        self.top.pop(0)
        self.top.append(self.get_random_sprite(self.bottom))
        return self.merged()


if __name__ == "__main__":
    world = World()
